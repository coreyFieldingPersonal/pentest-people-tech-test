import { useEffect, useState } from "react";

// Import Components.
import { Card } from ".";

// Import API.
import { fetchFilteredVulnerabilities } from "../api/fetchAllVulnerabilities";

const severityClasses: {[key: string]: string} = {
    CRITICAL: 'text-red-500',
    HIGH: 'text-orange-500',
    MEDIUM: 'text-yellow-500',
    LOW: 'text-green-500',
    INFO: 'text-green-500'
}

export const VulnerabilityCard = ({ status }: { status: string }) => {
    const [vulnerabilityCount, setVulnerabilityCount] = useState()

    useEffect(() => {
        const getVulnerabilitiesCount = async () => {
            const result = await fetchFilteredVulnerabilities(status)

            if (!result) return
    
            setVulnerabilityCount(result.length)
        }
        
        getVulnerabilitiesCount()
    }, [])

    return (
        <Card>
            <p className="text-gray-700"><span className={`font-bold ${severityClasses[status]}`}>{status}</span> Vulnerabilities</p>
            <p className={`text-4xl font-bold ${severityClasses[status]}`}>{vulnerabilityCount}</p>
        </Card>
    )
}